<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</title>

<style>
body{
  margin:0;
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  font-family:Arial;
  background:linear-gradient(135deg,#e8f5e9,#f1f8e9);
}

.card{
  background:white;
  padding:40px;
  width:350px;
  text-align:center;
  border-radius:20px;
  box-shadow:0 15px 35px rgba(0,0,0,0.15);
}

.option{
  padding:18px;
  margin:15px 0;
  background:#e0e0e0;
  border-radius:12px;
  cursor:pointer;
  font-size:20px;
  transition:0.3s;
}

.option:hover{
  background:#4CAF50;
  color:white;
}

.option.active{
  background:#4CAF50;
  color:white;
  font-weight:bold;
}

.hint{
  margin-top:20px;
  font-size:14px;
  color:#777;
}
</style>
</head>
<body>

<div class="card">
  <h2>üéÆ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</h2>

  <div class="option active" data-category="animal">Animal</div>
  <div class="option" data-category="fruit">Fruit</div>

  <div class="hint">
    ‡πÉ‡∏ä‡πâ ‚Üê ‚Üí ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏´‡∏°‡∏ß‡∏î<br>
    ‡∏Å‡∏î Enter ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°
  </div>
</div>

<script>
const options = document.querySelectorAll(".option");
let selectedIndex = 0;

function updateSelection(){
  options.forEach(opt=>opt.classList.remove("active"));
  options[selectedIndex].classList.add("active");
}

async function startGame(category){

  const name = localStorage.getItem("name");
  const password = localStorage.getItem("password");

  if(!name || !password){
    alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà");
    location.href="login.html";
    return;
  }

  await fetch("/api/start",{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({ name, password, category })
  });

  location.href="game.html";
}

/* ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏°‡∏≤‡∏™‡πå */
options.forEach((option,index)=>{
  option.addEventListener("click", ()=>{
    selectedIndex = index;
    updateSelection();
    startGame(option.dataset.category);
  });
});

/* ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏µ‡∏¢‡πå‡∏ö‡∏≠‡∏£‡πå‡∏î */
window.addEventListener("keydown", function(e){

  if(e.key === "ArrowRight"){
    selectedIndex = (selectedIndex + 1) % options.length;
    updateSelection();
  }

  if(e.key === "ArrowLeft"){
    selectedIndex = (selectedIndex - 1 + options.length) % options.length;
    updateSelection();
  }

  if(e.key === "Enter"){
    console.log("ENTER PRESSED");
    startGame(options[selectedIndex].dataset.category);
  }

});
</script>

</body>
</html>